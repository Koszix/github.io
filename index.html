<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ninja Clicker</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script type="module">
        // –ò–º–ø–æ—Ä—Ç Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js";
        import { getDatabase, ref, set, get } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-database.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-analytics.js";

        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDKyhYxdcZUqz3HJC2NF97FLCuN7bndNH8",
            authDomain: "ninjatapp00.firebaseapp.com",
            projectId: "ninjatapp00",
            storageBucket: "ninjatapp00.firebasestorage.app",
            messagingSenderId: "253236416484",
            appId: "1:253236416484:web:db84e76d445fa7d1bdc1f1",
            measurementId: "G-PF0DESMGR9"
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const analytics = getAnalytics(app);

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        const tg = window.Telegram.WebApp;
        tg.ready();

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const user = tg.initDataUnsafe.user;
        const userId = user?.id || generateUserId();
        const userName = user?.first_name || localStorage.getItem('userName');

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ ID
        function generateUserId() {
            return 'user_' + Math.random().toString(36).substr(2, 9);
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function saveUserData(userId, data) {
            set(ref(db, 'users/' + userId), data);
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function getUserData(userId, callback) {
            get(ref(db, 'users/' + userId)).then((snapshot) => {
                callback(snapshot.val());
            });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
        let score = 0;
        let upgrades = { clickPower: 1, autoClicker: false }; // –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω
        getUserData(userId, (data) => {
            if (data) {
                score = data.score || 0;
                upgrades = data.upgrades || { clickPower: 1, autoClicker: false };
                document.getElementById('score').textContent = score;

                // –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä–∞, –µ—Å–ª–∏ –æ–Ω –∫—É–ø–ª–µ–Ω
                if (upgrades.autoClicker) {
                    startAutoClicker();
                }
            }
        });

        // –ü–æ–∫–∞–∑ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞—Ö–æ–¥–µ
        if (!userName) {
            document.getElementById('welcomeModal').style.display = 'flex';
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏
        function saveName() {
            const inputName = document.getElementById('userName').value;
            if (inputName.trim() === "") {
                alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è.");
                return;
            }
            localStorage.setItem('userName', inputName);
            document.getElementById('welcomeModal').style.display = 'none';
            location.reload();
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞
        function clickButton() {
            score += upgrades.clickPower;
            document.getElementById('score').textContent = score;
            saveUserData(userId, { score: score, name: userName, upgrades: upgrades });
        }

        // –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä
        function startAutoClicker() {
            setInterval(() => {
                if (upgrades.autoClicker) {
                    score += 1; // –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä –¥–æ–±–∞–≤–ª—è–µ—Ç 1 –ö–∞—Ç–∞–Ω—É –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
                    document.getElementById('score').textContent = score;
                    saveUserData(userId, { score: score, name: userName, upgrades: upgrades });
                }
            }, 1000); // –ö–ª–∏–∫ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
        }

        // –ü–æ–∫—É–ø–∫–∞ –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä–∞ —á–µ—Ä–µ–∑ Telegram Pay
        function toClicker() {
            tg.showInvoice({
                title: "–ü–æ–∫—É–ø–∫–∞ –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä–∞",
                description: "–ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å 1 –ö–∞—Ç–∞–Ω—É –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É.",
                currency: "USD",
                prices: [{ label: "–ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä", amount: "100" }] // –°—Ç–æ–∏–º–æ—Å—Ç—å: 1 USD
            }, (status) => {
                if (status === "paid") {
                    upgrades.autoClicker = true;
                    saveUserData(userId, { score: score, name: userName, upgrades: upgrades });
                    startAutoClicker();
                    alert("–ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä —É—Å–ø–µ—à–Ω–æ –∫—É–ø–ª–µ–Ω!");
                } else {
                    alert("–û–ø–ª–∞—Ç–∞ –Ω–µ –ø—Ä–æ—à–ª–∞.");
                }
            });
        }

        // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
    </script>
    <style>
        /* –í–∞—à–∏ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
        .shop-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
        }

        .shop-content {
            background: #34495e;
            padding: 20px;
            border-radius: 10px;
            width: 80%;
            max-width: 400px;
            text-align: center;
        }

        .shop-content h2 {
            font-size: 2rem;
            margin-bottom: 20px;
            color: #e74c3c;
        }

        .shop-list div {
            padding: 10px;
            border-bottom: 1px solid #2c3e50;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Ninja Clicker</h1>
        <p>Your Katanas: <span id="score">0</span></p>
        <button class="ninja-button" onclick="clickButton()">
            <img src="ninja.png" alt="Ninja">
        </button>
    </div>

    <div class="bottom-bar">
        <button onclick="openWallet()">üí≥</button>
        <button onclick="openProfile()">üë§</button>
        <button onclick="buyAutoClicker()">‚≠ê –ö—É–ø–∏—Ç—å –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä</button>
        <button onclick="openTop100()">üèÜ –¢–æ–ø-100</button>
    </div>

    <div id="welcomeModal" class="modal">
        <div class="modal-content">
            <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h2>
            <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è:</p>
            <input type="text" id="userName" placeholder="–í–∞—à–µ –∏–º—è">
            <button onclick="saveName()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>

    <div id="shopModal" class="shop-modal">
        <div class="shop-content">
            <h2>–ú–∞–≥–∞–∑–∏–Ω —É–ª—É—á—à–µ–Ω–∏–π</h2>
            <div class="shop-list" id="shopList">
                <!-- –°–ø–∏—Å–æ–∫ —É–ª—É—á—à–µ–Ω–∏–π –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
            </div>
            <button onclick="closeShop()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <div id="topModal" class="top-modal">
        <div class="top-content">
            <h2>TOP</h2>
            <div class="top-list" id="topList">
                <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
            </div>
            <button onclick="closeTop100()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>
</body>
</html> buyAu