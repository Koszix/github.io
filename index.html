–ü—Ä–æ—Ñ–∏–ª—å</button>
        <button onclick="openTop100()">üèÜ –¢–æ–ø-100</button>
    </div>
    <div id="welcomeModal" class="modal">
        <div class="modal-content">
            <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h2>
            <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è:</p>
            <input type="text" id="userName" placeholder="–í–∞—à–µ –∏–º—è">
            <button onclick="saveName()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>
    
    <div id="walletPage" class="wallet-page">
        <div class="wallet-content">
            <h2>–ü—Ä–∏–≤—è–∑–∫–∞ –∫–æ—à–µ–ª—å–∫–∞</h2>
            <p>–ü—Ä–∏–≤—è–∂–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫, —á—Ç–æ–±—ã –ø–æ–∫—É–ø–∞—Ç—å —É–ª—É—á—à–µ–Ω–∏—è:</p>
            <button onclick="connectWallet()">üí≥ –ü—Ä–∏–≤—è–∑–∞—Ç—å –∫–æ—à–µ–ª–µ–∫</button>
            <h2>–ö—É–ø–∏—Ç—å –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä</h2>
            <button onclick="buyAutoClicker('1hour')">‚≠ê 1 —á–∞—Å (4,20$)</button>
            <button onclick="buyAutoClicker('4hours')">‚≠ê 4 —á–∞—Å–∞ (12,30$)</button>
            <button onclick="buyAutoClicker('16hours')">‚≠ê 16 —á–∞—Å–æ–≤ (37,10$)</button>
            <button onclick="closeWalletPage()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>
    
    <div id="topModal" class="top-modal">
        <div class="top-content">
            <h2>TOP</h2>
            <div class="top-list" id="topList">
                <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
            </div>
            <button onclick="closeTop100()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>
    
    <script type="module">
        // –ò–º–ø–æ—Ä—Ç Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js";
        import { getDatabase, ref, set, get } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-database.js";
    
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDKyhYxdcZUqz3HJC2NF97FLCuN7bndNH8",
            authDomain: "ninjatapp00.firebaseapp.com",
            projectId: "ninjatapp00",
            storageBucket: "ninjatapp00.appspot.com",
            messagingSenderId: "253236416484",
            appId: "1:253236416484:web:db84e76d445fa7d1bdc1f1",
            measurementId: "G-PF0DESMGR9"
        };
    
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
    
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        const tg = window.Telegram.WebApp;
        tg.ready();
    
        // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const user = tg.initDataUnsafe.user;
        const userId = user?.id || generateUserId();
        const userName = user?.first_name || localStorage.getItem('userName');
    
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ ID
        function generateUserId() {
            return 'user_' + Math.random().toString(36).substr(2, 9);
        }
    
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function saveUserData(userId, data) {
            set(ref(db, 'users/' + userId), data);
        }
    
        // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        async function getUserData(userId) {
            const snapshot = await get(ref(db, 'users/' + userId));
            return snapshot.val();
        }
    
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
        let score = 0;
        let upgrades = { clickPower: 1, autoClicker: null }; // –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω
    
        async function loadUserData() {
            const data = await getUserData(userId);
            if (data) {
                score = data.score || 0;
                upgrades = data.upgrades || { clickPower: 1, autoClicker: null };
                document.getElementById('score').textContent = score;
    
                // –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä–∞, –µ—Å–ª–∏ –æ–Ω –∞–∫—Ç–∏–≤–µ–Ω
                if (upgrades.autoClicker) {
                    startAutoClicker(upgrades.autoClicker);
                }
            }
        }
    
        loadUserData();
    
        // –ü–æ–∫–∞–∑ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞—Ö–æ–¥–µ
        if (!userName) {
            document.getElementById('welcomeModal').style.display = 'flex';
        }
    
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏
        function saveName() {
            const inputName = document.getElementById('userName').value;
            if (inputName.trim() === "") {
                alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è.");
                return;
            }
            localStorage.setItem('userName', inputName);
            document.getElementById('welcomeModal').style.display = 'none';
            location.reload();
        }
    
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞
        function clickButton() {
            score += upgrades.clickPower;
            document.getElementById('score').textContent = score;
            saveUserData(userId, { score: score, name: userName, upgrades: upgrades });
        }
        // –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä
    function startAutoClicker(autoClickerConfig) {
        const { interval, katanasPerClick, duration } = autoClickerConfig;

        const intervalId = setInterval(() => {
            score += katanasPerClick;
            document.getElementById('score').textContent = score;
            saveUserData(userId, { score: score, name: userName, upgrades: upgrades });
        }, interval * 1000);

        // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä–∞ —á–µ—Ä–µ–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è
        setTimeout(() => {
            clearInterval(intervalId);
            upgrades.autoClicker = null;
            saveUserData(userId, { score: score, name: userName, upgrades: upgrades });
            alert("–ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä –∑–∞–∫–æ–Ω—á–∏–ª —Å–≤–æ—é —Ä–∞–±–æ—Ç—É.");
        }, duration * 60 * 60 * 1000); // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —á–∞—Å—ã –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã
    }

    // –ü–æ–∫—É–ø–∫–∞ –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä–∞ —á–µ—Ä–µ–∑ Telegram Pay
    function buyAutoClicker(type) {
        const options = {
            "1hour": {
                title: "–ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä –Ω–∞ 1 —á–∞—Å",
                description: "–ö–ª–∏–∫–∞–µ—Ç –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥ –ø–æ 1 –ö–∞—Ç–∞–Ω–µ.",
                currency: "USD",
                prices: [{ label: "1 —á–∞—Å", amount: "420" }], // 4,20$
                interval: 10,
                katanasPerClick: 1,
                duration: 1 // 1 —á–∞—Å
            },
            "4hours": {
                title: "–ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä –Ω–∞ 4 —á–∞—Å–∞",
                description: "–ö–ª–∏–∫–∞–µ—Ç –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ –ø–æ 2 –ö–∞—Ç–∞–Ω—ã.",
                currency: "USD",
                prices: [{ label: "4 —á–∞—Å–∞", amount: "1230" }], // 12,30$
                interval: 5,
                katanasPerClick: 2,
                duration: 4 // 4 —á–∞—Å–∞
            },
            "16hours": {
                title: "–ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä –Ω–∞ 16 —á–∞—Å–æ–≤",
                description: "–ö–ª–∏–∫–∞–µ—Ç –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã –ø–æ 3 –ö–∞—Ç–∞–Ω—ã.",
                currency: "USD",
                prices: [{ label: "16 —á–∞—Å–æ–≤", amount: "3710" }], // 37,10$
                interval: 3,
                katanasPerClick: 3,
                duration: 16 // 16 —á–∞—Å–æ–≤
            }
        };

        const selectedOption = options[type];

        tg.showInvoice(selectedOption, (status) => {
            if (status === "paid") {
                upgrades.autoClicker = {
                    interval: selectedOption.interval,
                    katanasPerClick: selectedOption.katanasPerClick,
                    duration: selectedOption.duration
                };
                saveUserData(userId, { score: score, name: userName, upgrades: upgrades });
                startAutoClicker(upgrades.autoClicker);
                alert("–ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä —É—Å–ø–µ—à–Ω–æ –∫—É–ø–ª–µ–Ω!");
            } else {
                alert("–û–ø–ª–∞—Ç–∞ –Ω–µ –ø—Ä–æ—à–ª–∞.");
            }
        });
    }

    // –û—Ç–∫—Ä—ã—Ç–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –∫–æ—à–µ–ª—å–∫–æ–º
    function openWalletPage() {
        document.getElementById('walletPage').style.display = 'flex';
    }

    // –ó–∞–∫—Ä—ã—Ç–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –∫–æ—à–µ–ª—å–∫–æ–º
    function closeWalletPage() {
        document.getElementById('walletPage').style.display = 'none';
    }

    // –ü—Ä–∏–≤—è–∑–∫–∞ –∫–æ—à–µ–ª—å–∫–∞ (–∑–∞–≥–ª—É—à–∫–∞)
    function connectWallet() {
        alert("–§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–≤—è–∑–∫–∏ –∫–æ—à–µ–ª—å–∫–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.");
    }

    // –û—Ç–∫—Ä—ã—Ç–∏–µ —Ç–æ–ø–∞
    async function openTop100() {
        const topList = document.getElementById('topList');
        topList.innerHTML = ''; // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        const snapshot = await get(ref(db, 'users'));
        const users = [];
        snapshot.forEach((childSnapshot) => {
            const userData = childSnapshot.val();
            users.push({
                id: childSnapshot.key,
                name: userData.name || "–ê–Ω–æ–Ω–∏–º",
                score: userData.score || 0
            });
        });

        // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —É–±—ã–≤–∞–Ω–∏—é
        users.sort((a, b) => b.score - a.score);

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞
        users.slice(0, 100).forEach((user, index) => {
            const userDiv = document.createElement('div');
            userDiv.textContent = `${index + 1}-–º–µ—Å—Ç–æ: ${user.name} - ${user.score} –ö–∞—Ç–∞–Ω`;
            topList.appendChild(userDiv);
        });

        document.getElementById('topModal').style.display = 'flex';
    }

    // –ó–∞–∫—Ä—ã—Ç–∏–µ —Ç–æ–ø–∞
    function closeTop100() {
        document.getElementById('topModal').style.display = 'none';
    }

    // –û—Ç–∫—Ä—ã—Ç–∏–µ –ø—Ä–æ—Ñ–∏–ª—è (–∑–∞–≥–ª—É—à–∫–∞)
    function openProfile() {
        alert("–§—É–Ω–∫—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.");
    }
    </script>
  </body>
</html>   