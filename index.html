<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ninja Clicker</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ */
        body {
            margin: 0;
            padding: 0;
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: #ecf0f1;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            touch-action: manipulation;
        }

        .container {
            text-align: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        #score {
            font-size: 2rem;
            margin-bottom: 30px;
            color: #e74c3c;
        }

        .ninja-button {
            background: none;
            border: none;
            cursor: pointer;
            transition: transform 0.1s ease;
            touch-action: none;
        }

        .ninja-button img {
            width: 150px;
            height: 150px;
            transition: transform 0.1s ease;
        }

        .ninja-button:active img {
            transform: translateY(10px);
        }

        .bottom-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-around;
            align-items: center;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px;
        }

        .bottom-bar button {
            background: none;
            border: none;
            color: #ecf0f1;
            font-size: 1.2rem;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .bottom-bar button:hover {
            transform: scale(1.1);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: #34495e;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .modal-content input {
            padding: 10px;
            margin: 10px 0;
            border: none;
            border-radius: 5px;
            width: 80%;
        }

        .modal-content button {
            padding: 10px 20px;
            background: #e74c3c;
            border: none;
            border-radius: 5px;
            color: #ecf0f1;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .modal-content button:hover {
            background: #c0392b;
        }

        .shop-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
        }

        .shop-content {
            background: #34495e;
            padding: 20px;
            border-radius: 15px;
            width: 80%;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .shop-content h2 {
            font-size: 2rem;
            margin-bottom: 20px;
            color: #e74c3c;
        }

        .shop-list div {
            padding: 10px;
            border-bottom: 1px solid #2c3e50;
        }

        .wallet-page {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
        }

        .wallet-content {
            background: #34495e;
            padding: 20px;
            border-radius: 15px;
            width: 80%;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .wallet-content h2 {
            font-size: 2rem;
            margin-bottom: 20px;
            color: #e74c3c;
        }

        .wallet-content button {
            margin: 10px;
            padding: 10px 20px;
            background: #e74c3c;
            border: none;
            border-radius: 5px;
            color: #ecf0f1;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .wallet-content button:hover {
            background: #c0392b;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Ninja Clicker</h1>
        <p>Your Katanas: <span id="score">0</span></p>
        <button class="ninja-button" onclick="clickButton()">
            <img src="ninja.png" alt="Ninja">
        </button>
    </div>

    <div class="bottom-bar">
        <button onclick="openWalletPage()">üí≥ –ü—Ä–∏–≤—è–∑–∞—Ç—å –∫–æ—à–µ–ª–µ–∫</button>
        <button onclick="openProfile()">üë§ –ü—Ä–æ—Ñ–∏–ª—å</button>
        <button onclick="openTop100()">üèÜ –¢–æ–ø-100</button>
    </div>

    <div id="welcomeModal" class="modal">
        <div class="modal-content">
            <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h2>
            <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è:</p>
            <input type="text" id="userName" placeholder="–í–∞—à–µ –∏–º—è">
            <button onclick="saveName()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>

    <div id="walletPage" class="wallet-page">
        <div class="wallet-content">
            <h2>–ü—Ä–∏–≤—è–∑–∫–∞ –∫–æ—à–µ–ª—å–∫–∞</h2>
            <p>–ü—Ä–∏–≤—è–∂–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫, —á—Ç–æ–±—ã –ø–æ–∫—É–ø–∞—Ç—å —É–ª—É—á—à–µ–Ω–∏—è:</p>
            <button onclick="connectWallet()">üí≥ –ü—Ä–∏–≤—è–∑–∞—Ç—å –∫–æ—à–µ–ª–µ–∫</button>
            <h2>–ö—É–ø–∏—Ç—å –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä</h2>
            <button onclick="buyAutoClicker('1hour')">‚≠ê 1 —á–∞—Å (4,20$)</button>
            <button onclick="buyAutoClicker('4hours')">‚≠ê 4 —á–∞—Å–∞ (12,30$)</button>
            <button onclick="buyAutoClicker('16hours')">‚≠ê 16 —á–∞—Å–æ–≤ (37,10$)</button>
            <button onclick="closeWalletPage()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <div id="topModal" class="top-modal">
        <div class="top-content">
            <h2>TOP</h2>
            <div class="top-list" id="topList">
                <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
            </div>
            <button onclick="closeTop100()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <script type="module">
        // –ò–º–ø–æ—Ä—Ç Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js";
        import { getDatabase, ref, set, get } from "https://www.gstatic.com/firebasejs/10.1.0/firebase-database.js";

        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDKyhYxdcZUqz3HJC2NF97FLCuN7bndNH8",
            authDomain: "ninjatapp00.firebaseapp.com",
            projectId: "ninjatapp00",
            storageBucket: "ninjatapp00.firebasestorage.app",
            messagingSenderId: "253236416484",
            appId: "1:253236416484:web:db84e76d445fa7d1bdc1f1",
            measurementId: "G-PF0DESMGR9"
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        const tg = window.Telegram.WebApp;
        tg.ready();

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const user = tg.initDataUnsafe.user;
        const userId = user?.id || generateUserId();
        const userName = user?.first_name || localStorage.getItem('userName');

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è—É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ ID
        function generateUserId() {
            return 'user_' + Math.random().toString(36).substr(2, 9);
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function saveUserData(userId, data) {
            set(ref(db, 'users/' + userId), data);
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        async function getUserData(userId) {
            const snapshot = await get(ref(db, 'users/' + userId));
            return snapshot.val();
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
        let score = 0;
        let upgrades = { clickPower: 1, autoClicker: null }; // –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω

        async function loadUserData() {
            const data = await getUserData(userId);
            if (data) {
                score = data.score || 0;
                upgrades = data.upgrades || { clickPower: 1, autoClicker: null };
                document.getElementById('score').textContent = score;

                // –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä–∞, –µ—Å–ª–∏ –æ–Ω –∞–∫—Ç–∏–≤–µ–Ω
                if (upgrades.autoClicker) {
                    startAutoClicker(upgrades.autoClicker);
                }
            }
        }

        loadUserData();

        // –ü–æ–∫–∞–∑ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞—Ö–æ–¥–µ
        if (!userName) {
            document.getElementById('welcomeModal').style.display = 'flex';
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏
        function saveName() {
            const inputName = document.getElementById('userName').value;
            if (inputName.trim() === "") {
                alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è.");
                return;
            }
            localStorage.setItem('userName', inputName);
            document.getElementById('welcomeModal').style.display = 'none';
            location.reload();
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞
        function clickButton() {
            score += upgrades.clickPower;
            document.getElementById('score').textContent = score;
            saveUserData(userId, { score: score, name: userName, upgrades: upgrades });
        }

        // –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä
        function startAutoClicker(autoClickerConfig) {
            const { interval, katanasPerClick, duration } = autoClickerConfig;

            const intervalId = setInterval(() => {
                score += katanasPerClick;
                document.getElementById('score').textContent = score;
                saveUserData(userId, { score: score, name: userName, upgrades: upgrades });
            }, interval * 1000);

            // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä–∞ —á–µ—Ä–µ–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è
            setTimeout(() => {
                clearInterval(intervalId);
                upgrades.autoClicker = null;
                saveUserData(userId, { score: score, name: userName, upgrades: upgrades });
                alert("–ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä –∑–∞–∫–æ–Ω—á–∏–ª —Å–≤–æ—é —Ä–∞–±–æ—Ç—É.");
            }, duration * 60 * 60 * 1000); // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —á–∞—Å—ã –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã
        }

        // –ü–æ–∫—É–ø–∫–∞ –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä–∞ —á–µ—Ä–µ–∑ Telegram Pay
        function buyAutoClicker(type) {
            const options = {
                "1hour": {
                    title: "–ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä –Ω–∞ 1 —á–∞—Å",
                    description: "–ö–ª–∏–∫–∞–µ—Ç –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥ –ø–æ 1 –ö–∞—Ç–∞–Ω–µ.",
                    currency: "USD",
                    prices: [{ label: "1 —á–∞—Å", amount: "420" }], // 4,20$
                    interval: 10,
                    katanasPerClick: 1,
                    duration: 1 // 1 —á–∞—Å
                },
                "4hours": {
                    title: "–ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä –Ω–∞ 4 —á–∞—Å–∞",
                    description: "–ö–ª–∏–∫–∞–µ—Ç –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ –ø–æ 2 –ö–∞—Ç–∞–Ω—ã.",
                    currency: "USD",
                    prices: [{ label: "4 —á–∞—Å–∞", amount: "1230" }], // 12,30$
                    interval: 5,
                    katanasPerClick: 2,
                    duration: 4 // 4 —á–∞—Å–∞
                },
                "16hours": {
                    title: "–ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä –Ω–∞ 16 —á–∞—Å–æ–≤",
                    description: "–ö–ª–∏–∫–∞–µ—Ç –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã –ø–æ 3 –ö–∞—Ç–∞–Ω—ã.",
                    currency: "USD",
                    prices: [{ label: "16 —á–∞—Å–æ–≤", amount: "3710" }], // 37,10$
                    interval: 3,
                    katanasPerClick: 3,
                    duration: 16 // 16 —á–∞—Å–æ–≤
                }
            };

            const selectedOption = options[type];

            tg.showInvoice(selectedOption, (status) => {
                if (status === "paid") {
                    upgrades.autoClicker = {
                        interval: selectedOption.interval,
                        katanasPerClick: selectedOption.katanasPerClick,
                        duration: selectedOption.duration
                    };
                    saveUserData(userId, { score: score, name: userName, upgrades: upgrades });
                    startAutoClicker(upgrades.autoClicker);
                    alert("–ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä —É—Å–ø–µ—à–Ω–æ –∫—É–ø–ª–µ–Ω!");
                } else {
                    alert("–û–ø–ª–∞—Ç–∞ –Ω–µ –ø—Ä–æ—à–ª–∞.");
                }
            });
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –∫–æ—à–µ–ª—å–∫–æ–º
        function openWalletPage() {
            document.getElementById('walletPage').style.display = 'flex';
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –∫–æ—à–µ–ª—å–∫–æ–º
        function closeWalletPage() {
            document.getElementById('walletPage').style.display = 'none';
        }

        // –ü—Ä–∏–≤—è–∑–∫–∞ –∫–æ—à–µ–ª—å–∫–∞ (–∑–∞–≥–ª—É—à–∫–∞)
        function connectWallet() {
            alert("–§—É–Ω–∫—Ü–∏—è –ø—Ä–∏–≤—è–∑–∫–∏ –∫–æ—à–µ–ª—å–∫–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.");
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ —Ç–æ–ø–∞
        async function openTop100() {
            const topList = document.getElementById('topList');
            topList.innerHTML = ''; // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫

            // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            const snapshot = await get(ref(db, 'users'));
            const users = [];
            snapshot.forEach((childSnapshot) => {
                const userData = childSnapshot.val();
                users.push({
                    id: childSnapshot.key,
                    name: userData.name || "–ê–Ω–æ–Ω–∏–º",
                    score: userData.score || 0
                });
            });

            // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —É–±—ã–≤–∞–Ω–∏—é
            users.sort((a, b) => b.score - a.score);

            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞
            users.slice(0, 100).forEach((user, index) => {
                const userDiv = document.createElement('div');
                userDiv.textContent = `${index + 1}-–º–µ—Å—Ç–æ: ${user.name} - ${user.score} –ö–∞—Ç–∞–Ω`;
                topList.appendChild(userDiv);
            });

            document.getElementById('topModal').style.display = 'flex';
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ —Ç–æ–ø–∞
        function closeTop100() {
            document.getElementById('topModal').style.display = 'none';
        }

        // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
    </script>
</head>
<body>
    <div class="container">
        <h1>Ninja Clicker</h1>
        <p>Your Katanas: <span id="score">0</span></p>
        <button class="ninja-button" onclick="clickButton()">
            <img src="ninja.png" alt="Ninja">
        </button>
    </div>

    <div class="bottom-bar">
        <button onclick="openWalletPage()">üí≥ –ü—Ä–∏–≤—è–∑–∞—Ç—å –∫–æ—à–µ–ª–µ–∫</button>
        <button onclick="openProfile()">üë§</button>
        <button onclick="buyAutoClicker('1hour')">‚≠ê 1 —á–∞—Å (4,20$)</button>
        <button onclick="buyAutoClicker('4hours')">‚≠ê 4 —á–∞—Å–∞ (12,30$)</button>
        <button onclick="buyAutoClicker('16hours')">‚≠ê 16 —á–∞—Å–æ–≤ (37,10$)</button>
        <button onclick="openTop100()">üèÜ –¢–æ–ø-100</button>
    </div>

    <div id="welcomeModal" class="modal">
        <div class="modal-content">
            <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h2>
            <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è:</p>
            <input

type="text" id="userName" placeholder="–í–∞—à–µ –∏–º—è">
            <button onclick="saveName()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>

    <div id="shopModal" class="shop-modal">
        <div class="shop-content">
            <h2>–ú–∞–≥–∞–∑–∏–Ω —É–ª—É—á—à–µ–Ω–∏–π</h2>
            <div class="shop-list" id="shopList">
                <!-- –°–ø–∏—Å–æ–∫ —É–ª—É—á—à–µ–Ω–∏–π –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
            </div>
            <button onclick="closeShop()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <div id="topModal" class="top-modal">
        <div class="top-content">
            <h2>TOP</h2>
            <div class="top-list" id="topList">
                <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
            </div>
            <button onclick="closeTop100()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>
</body>
</html>.autoCl